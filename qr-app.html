<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>QR Profile App</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root {
  --bg:#f7f7f8; --text:#111; --card:#fff; --border:#ddd; --accent:#4A6CF7;
}
[data-theme="dark"] {
  --bg:#121212; --text:#eee; --card:#1e1e1e; --border:#333; --accent:#6d8bff;
}
body {
  font-family:Inter,sans-serif; background:var(--bg); color:var(--text);
  margin:0;
}
header {
  padding:20px; background:var(--card); border-bottom:1px solid var(--border);
  text-align:center; font-size:24px; font-weight:600; position:relative;
}
.toggle-dark {
  position:absolute; right:20px; top:20px; padding:6px 14px;
  background:var(--card); border:1px solid var(--border); border-radius:6px;
  cursor:pointer;
}
nav {
  display:flex; justify-content:center; gap:12px; padding:20px;
}
nav button {
  padding:10px 16px; border:none; border-radius:6px; background:var(--accent);
  color:white; cursor:pointer;
}
.page { display:none; max-width:500px; margin:auto; padding:20px; }
.page.active { display:block; }
.card {
  background:var(--card); border:1px solid var(--border); border-radius:10px;
  padding:20px;
}
input {
  width:100%; padding:12px; border:1px solid var(--border); border-radius:6px;
  margin-bottom:12px; background:var(--bg); color:var(--text);
}
.btn-main {
  width:100%; padding:12px; background:var(--accent); color:white;
  border:none; border-radius:6px; cursor:pointer;
}
#qrcode { margin-top:20px; text-align:center; }
pre {
  padding:15px; background:var(--card); border:1px solid var(--border);
  border-radius:8px; white-space:pre-wrap;
}
</style>
</head>
<body>
<header>
  QR Profile App
  <button class="toggle-dark" onclick="toggleDarkMode()">Dark Mode</button>
</header>

<nav>
  <button onclick="showPage('createPage')">Create QR</button>
  <button onclick="showPage('scanPage')">Scan QR</button>
</nav>

<!-- CREATE PAGE -->
<div id="createPage" class="page active">
  <div class="card">
    <h3>Create QR Code</h3>
    <input id="name" placeholder="Name">
    <input id="mbti" placeholder="MBTI (e.g., INFP)">
    <input id="location" placeholder="Location">
    <button class="btn-main" onclick="generateQR()">Generate QR</button>
    <div id="qrcode"></div>
  </div>
</div>

<!-- SCAN PAGE -->
<div id="scanPage" class="page">
  <div class="card">
    <h3>Scan QR</h3>
    <div id="reader" style="width:100%;"></div>
    <h4>Result:</h4>
    <pre id="scanResult">Waiting...</pre>
  </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://unpkg.com/html5-qrcode"></script>

<script>
function toggleDarkMode(){
  const t=document.documentElement.getAttribute("data-theme");
  document.documentElement.setAttribute("data-theme", t==="dark"?"light":"dark");
}

function showPage(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  if(id==="scanPage") startScanner();
}

function generateQR(){
  const data={
    name:document.getElementById("name").value,
    mbti:document.getElementById("mbti").value,
    location:document.getElementById("location").value
  };
  document.getElementById("qrcode").innerHTML="";
  new QRCode(document.getElementById("qrcode"), JSON.stringify(data));
}

let scanner=null;
function startScanner(){
  if(scanner) return;

  scanner=new Html5Qrcode("reader");

  Html5Qrcode.getCameras().then(devices=>{
    scanner.start(
      devices[0].id,
      {fps:10, qrbox:250},
      message=>{
        try{
          document.getElementById("scanResult").textContent =
            JSON.stringify(JSON.parse(message), null, 2);
        }catch(e){
          document.getElementById("scanResult").textContent = message;
        }
      }
    );
  });
}
</script>
</body>
</html>
